Update: This data can now be generated within the Kenna UI using the new "Assets without vulnerabilities" filter in Explore view under the "Additional Filters" section.

# Find Kenna assets with zero vulnerabilities

Kenna's query language does not provide the capability to query for assets with a vulnerability count of zero, however the API helpfully provides a "vulnerabilities_count" field on the asset export record. This Python script searches through an export of all active assets to find those with a vulnerability count of zero.

Two filtered files are output after the data is manipulated. The "no_vulns_assets.json" file includes all metadata for each zero-vulnerabilty asset, while the "no_vulns_asset_id_list.CSV" file is simply a list of Kenna asset IDs which do not have any open vulnerabilities on them. The json can be used for manual verification, analysis, and historical record keeping, while the csv file can be used to mark the assets inactive with the API, or the file can be provided to Kenna support for assistance. The script also outputs the raw gzip and jsonl export files used for the data analysis. A logging file is also created after the script runs for the first time, then updated after each run.

Please note that this script is designed to be run against Kenna's Prod 1 environment. You can adjust the URL in line 170 to run the script against a different Kenna environment.


## Dependencies

### Environment

Kenna API token defined as a system environment variable `KENNA_API_KEY`

[Linux/Mac Instructions](https://phoenixnap.com/kb/set-environment-variable-mac)

[Windows Instructions](https://docs.oracle.com/en/database/oracle/machine-learning/oml4r/1.5.1/oread/creating-and-modifying-environment-variables-on-windows.html)

### Language

Python 3

## Usage Instructions

#### Requirements Installation

`pip3 install -r requirements.txt`

#### Run Script 

`python zero_vuln_assets.py`

## Credit

Asset export code is taken from @github/rick-kenna 's work on [export_assets.py](https://github.com/KennaSecurity/blog_samples/blob/main/python/vulns_per_assets/export_assets.py)
