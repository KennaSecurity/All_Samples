# Kenna Vulnerability Status Setter
This script will override Kenna status for select vulnerabilities.  If the number of vulnerabilities is over 10,000, then a data export is preformed.

## Usage:

```
status_setter_mt.rb <Kenna API token> <CSV file of status overrides>
```

### Parameters:
 - token = Kenna Application token
 - csv_file = csv file with status overrides

### Tested on:

- ruby 2.6.10p210 (2022-04-12 revision 67958) [universal.x86_64-darwin22]

### Required Ruby classes/gems:

- [`rest-client`](https://github.com/rest-client/rest-client)
- [`json`](http://ruby-doc.org/stdlib-2.0.0/libdoc/json/rdoc/JSON.html)
- [`csv`](http://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html)
- [`thread`](https://ruby-doc.org/core-2.2.0/Thread.html)
- [`monitor`](https://ruby-doc.org/stdlib-2.1.2/libdoc/monitor/rdoc/Monitor.html)

### CSV Expected Columns

- Reset_Type = Search param to be used to find rescore items (scanner_id, vulnerability_name, cve, cwe, scanner_id, fix_title_keyword, fix_id, scanner_score)
- Value = Corresponding value to be pair with search team in Reset_Type
- Current_Status = Vulnerability score to search for before rescore (example 0 to find only new informational items)
- New_Status = The new status to be set for each vulnerability found 
- Tags = Comma separated list of tags to be included in search
- Tag_Operator = AND or OR to be used for items in Tags
- Set_Due_Date = Due date to add to the changed records
- Set_Custom_Field_Data = json of all custom field values to be updated on the records
```
  "custom_fields": {
          "8097": "we said yes","8096": "second cf updated"
        }
```
