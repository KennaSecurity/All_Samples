# Vulnerability CSV reports

Scripts product CSV reports

vuln_reporting.rb produces csv reports and optionally send them via email 

Meta File should have 3 columns

query
query_name
email_recipients

Script will process a report for each line in the meta file and optionally email it to the listed recipient(s)

vuln_reporting.rb Kenna_API_token instruction_meta_file.csv include_solution? send_mail? opt_mail_server opt_port opt_username opt_password opt_from_address

If send_mail = true then opt params are required. 

Required Ruby classes/gems:

rest-client
json
mail


__________________________________________________________________________________________________________________


csv_extract_with_details.rb will produce a report of all vulnerabilities in Kenna including details. 

The script pages through all assets and then uses groups of assets ids to pull down vulnerabilities in chunks small enough to include details. 

csv_extract_with_details.rb Kenna_API_token assetsPerQuery OutputReportName IncludeDetails optRiskMeterID optBase_url

assetsPerQuery - should be adjusted so that the vulns pulled back does not exceed 20 pages. Script with throw and error if 20 pages are exceeded.
OutputReportName - CSV file that will hold the results.
IncludeDetails - true or false (note you must have platform permissions for your Kenna Instance to export details)
optRiskMeterID - if risk meter (asset group) id is provided, only assets/vulns from that risk meter will be returned in the query. If left null, all active assets will be used for the vuln query. 
optBase_url - defaults to US API url, but should be set for EU or private deployments

Tested on:
ruby 2.6.3p62 (2019-04-16 revision 67580) [universal.x86_64-darwin19]

Required Ruby classes/gems:

rest-client
json

